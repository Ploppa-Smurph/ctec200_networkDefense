<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTEC 200 Network Defense wk03: Lessons 06 -; 07 -; 08 -</title>
</head>
<body>
<pre>
<h1>CTEC 200 Network Defense wk03:  Lessons 06 - Scanning Logical Vulnerabilities; 07 - ; 08 - </h1>
<h2>Lesson 06: Scanning Logical Vulnerabilities</h2>
<h3>06A - Scan Identified Targets</h3>
<h4>RECOGNIZING THE DIFFERENT TYPES OF SCANS</h4>
<b>Discovering Network Hosts</b>

<b>Scanning Ports</b>
    <b>Port Scanning</b>

<b>Fully Connecting with the Target</b>

<b>Operating in Stealth Mode</b>
    <i><b>- TCP SYN scan</b></i> - half-open scan; original stealth scan.
    <i><b>- FIN scan</b></i> - sends packet with only FIN flag set
    <i><b>- NULL scan</b></i> - packet sent with NO flags
    <i><b>- XMAS Tree Scan</b></i> - send FIN, URG, and PSH flags

<h4>ASSESSING VULNERABLE WEB APPLICATIONS</h4>
<b>Crawling Web Applications</b>
    <i><b>- Credentialed scan</b></i>
    <i><b>- Non-credentialed scan</b></i> -- fewer permissions; finds missing patches & updates

<b>Examining API Requests</b> - look for exposed authorization tokens / non-encrypted key information

<h4>AUTOMATING VULNERABILITY SCANNING</h4>
<b>SAST (Static Application Security Testing)</b>

<b>DAST (Dynamic Application Security Testing)</b>

<b>SCAP (Security Content Automation Protocol)</b>

<h3>06B - Evaluate Network Traffic</h3>
<h4>SNIFFING USING WIRESHARK</h4>
<b>SPAN (Switched Port Analysis)</b>

<b>Discovering Network Hosts</b>
    <i><b>NetBIOS name service (NBNS)</b></i>

    <i><b>AD (Active Directory)</b></i>

    <i><b>CName (Canonical Name)</b></i>

    <i><b>DHCP (Dynamic Host Configuration Protocol)</b></i>

    <i><b>Client Identifier (MAC address)</b></i>

<h4>SCANNING WITH NESSUS</h4>
<b>Nessus</b> - 

<b>Testing for Network Segmentation</b> 

<b>ARP (Address Resolution Protocol)</b> - 

<h4>GATHERING ARP TRAFFIC</h4> 
<b>ARP Poisoning</b>

<i><b>Nessus</b></i>
<i><b>'Nmap -PR -sn' + target</b></i>: -PR = ARP ping; -sn = disable Port scan
<i><b>Arping</b></i>

<h3>06C Uncover Wireless Assets</h3>
<h4>WAR DRIVING OPEN ACCESS POINTS</h4>
<b>WAP (Wireless Access Point)</b>

<b>War Driving</b>

<b>Mapping WAP using 'WiGLE'</b>
    WiGLE is an OSINT tool

<h4>AMPLIFYING THE WI-FI SIGNAL</h4>
<b>SNR (Signal-to-Noise Ratio)</b>

<b>dBi (decibels per isotropic)</b>

<h3>Lab 06:</h3>

<h2>Lesson 07: Analyzing Scanning Results</h2>
<h3>07A - Discover Nmap and NSE</h3>
<h4>COVERING THE BASICS</h4>
<b>Timing and Performance Considerations</b>
    <i><b>T0 and T1</b></i> - best option but slow
    <i><b>T2</b></i>        - slower scan to preserve bandwidth
    <i><b>T3</b></i>        - default and most stable option
    <i><b>T4</b></i>        - fast and stable
    <i><b>T5</b></i>        - fast, but unstable

<b>Rate Limiting</b>

<b>Using TCP or UDP</b>

<b>TCP</b>:  
    <i><b>- </b></i>
    <i><b>- </b></i>
    <i><b>- </b></i>

<b>UDP</b>:
    <i><b>- </b></i>
    <i><b>- </b></i>
    <i><b>- </b></i>
<h4>SCRIPTING WITH NMAP</h4>
<b>NSE (Nmap Scripting Engine)</b>
    <i><b>- Malware</b></i>

    <i><b>- Discovery</b></i>

    <i><b>- Vulnerabilities</b></i>

<h3>07B - Enumerate Network Hosts</h3>
<h4>DETECTING INTERESTING HOSTS</h4>
<b>Ping Scans</b> - ping range of IP addresses to learn which machines are responding

<b>TCP Scans</b> - check for open / listening TCP ports to determine services used

<b>OS Footprinting</b> - IDs operating system on system

<b>Nmap defaults</b>: 
    - <i>TCP SYN</i> - packet to port 443
    - <i>TCP ACK</i> - packet to port 80
    - <i>ICMP type 8</i> - echo request
    - <i>ICMP type 13</i> - timestamp request
    - <i>ARP</i> - request to obtain MAC address details

<i><b>If firewall blocks ICMP pings try</b></i>:
    - <i>TCP ACK Ping</i> - <b><i>-PA ((portlist)</i></b> -- set ACK (acknowledgement) flag in TCP header
    - <i>UDP Ping</i> - <b><i>-PU (portlist)</i></b> -- scan uses User Datagram Protocol UDP
    - <i>SCTP Initiation Ping</i> - <b><i>-sY (portlist)</i></b> -- scan uses SCTP (Stream Control Transmission Protocol) [alternate to TCP or UDP]
    - <i>TCP SYN Ping</i> <b><i>-PS (target)</i></b> -- sends empty TCP packet with SYN flag set to port specified

<b>4 Nmap Port States</b>:
    - OPEN       - port is open and responding to probes
    - CLOSED     - port is not responding to probes
    - FILTERED   - port is blocked by firewall
    - UNFILTERED - port is accessible; however Nmap is unable to determine if port is OPEN or CLOSED   

<b>Host Discovery Phase Options</b>:
    - '-Pn' = skip discovery phase altogether and treat hosts as if they are online by using the switch
    - '-sn' = complete network discovery without port scan
    - '-Pn -sn' = use both -Pn & -sn to run without either a ping or port scan.

<h4>FINGERPRINTING THE OS</h4>
<b>Passively Gathering Traffic</b>
    <b><i>- OS Fingerprinting</i></b>
    <b><i>- PCAP (packet capture)</i></b>

<b>Actively Sending Probes</b>

<b>Key Elements Used to Determine the OS include</b>:
    <b><i>(DF) Don't Fragment bit</i></b> - is the DF bit in the IPv4 header on or off?
    <b><i>(WS) Window Size</i></b> - What does the OS use as a WS?
    <b><i>(TTL) Time to Live</i></b> - what is TTL value set on outbound packet?

<h3>07C - Analyze Output from Scans</h3>
<h4>EXAMINING NETWORK TRAFFIC</h4>
<b>Unknown Environment</b> - 

<b>Partially Known Environment</b> - 

<b>Known Environment</b> - 

<b>Reporting with Nmap</b>
    <i>-default</i> =  Interactive output
    <i>'-oX'</i> =     XML output
    <i>'-oG'</i> = Grepable output
    <i>'-oN'</i>n = similar to interactive, but can save reults of Nmap to text file for later analysis

<b>Interfacing with Zenmap</b>

<h4>EVALUATING DNS AND WEB LOGS</h4>
<b>Testing DNS</b>

<b>Recognizing Normal Behavior</b>

<b>Transferring Zone Information</b>
    <b><i>A</i></b>
    <b><i>AAAA</i></b>
    <b><i>PTR</i></b>
    <b><i>MX</i></b>
    
    ** DNS Zone Transfer is sometimes referred to an (AXFR) Authoritative Transfer

<b>Poisoning the Cache</b>

<h4>EXPOSING VULNERABLE WEB SERVERS</h4>
Burp Suite

<h3>Lab 07: Using Web Scanners</h3>

<h2>Lesson 08: </h2>
<h3>08A - </h3>
<h3>08B - </h3>
<h3>08C - </h3>

<h3>Lab 08: Understanding Nmap Common Usage</h3>


</pre>
</body>
</html>